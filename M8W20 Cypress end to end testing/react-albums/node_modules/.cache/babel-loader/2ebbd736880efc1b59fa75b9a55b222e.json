{"ast":null,"code":"import _defineProperty from \"/Users/alvinng/LHL-full-time-teaching/webflex-lecture-notes-oct-2022/M8W20 Cypress end to end testing/react-albums/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/alvinng/LHL-full-time-teaching/webflex-lecture-notes-oct-2022/M8W20 Cypress end to end testing/react-albums/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/alvinng/LHL-full-time-teaching/webflex-lecture-notes-oct-2022/M8W20 Cypress end to end testing/react-albums/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/alvinng/LHL-full-time-teaching/webflex-lecture-notes-oct-2022/M8W20 Cypress end to end testing/react-albums/src/components/LiveSearch.js\";\nimport React, { Fragment, useState, useEffect, useRef } from \"react\";\nimport { differenceInDays } from \"date-fns\";\nimport axios from \"axios\";\nimport SearchBar from \"components/SearchBar\";\nimport Error from \"components/Error\";\nimport Filters from \"components/Filters\";\nimport Results from \"components/Results\";\nexport default function LiveSearch(props) {\n  var _useState = useState({\n    term: \"\",\n    results: [],\n    loading: false\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      search = _useState2[0],\n      setSearch = _useState2[1];\n\n  var _useState3 = useState({\n    Explicit: true,\n    \"1900s\": true,\n    \"2000s\": true,\n    Single: false,\n    EP: false\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      filters = _useState4[0],\n      setFilters = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      error = _useState6[0],\n      setError = _useState6[1];\n\n  var prev = useRef(\"\");\n\n  function showError() {\n    setSearch({\n      term: \"\",\n      results: [],\n      loading: false\n    });\n    setError(true);\n  }\n\n  useEffect(function () {\n    if (prev.current === \"\" && search.term === \"\") return;\n    setSearch(function (prev) {\n      return _objectSpread({}, prev, {\n        loading: true\n      });\n    });\n    prev.current = search.term;\n    axios.get(\"https://itunes.apple.com/search?term=\".concat(search.term, \"&country=CA&media=music&entity=album&attribute=artistTerm\")).then(function (response) {\n      response.data.results.sort(function (a, b) {\n        return differenceInDays(new Date(b.releaseDate), new Date(a.releaseDate));\n      });\n      setSearch(function (search) {\n        return _objectSpread({}, search, {\n          results: response.data.results,\n          loading: false\n        });\n      });\n    }).catch(function (error) {\n      showError();\n    });\n  }, [search.term]);\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, React.createElement(\"header\", {\n    className: \"logo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: \"images/brand.png\",\n    alt: \"Brand\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  })), React.createElement(\"main\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, React.createElement(SearchBar, {\n    loading: search.loading,\n    onSearch: function onSearch(term) {\n      return setSearch(_objectSpread({}, search, {\n        term: term\n      }));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }), React.createElement(Error, {\n    show: error,\n    onClose: function onClose(event) {\n      return setError(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, \"The server returned an error.\"), React.createElement(Filters, {\n    filters: filters,\n    setFilter: function setFilter(filter, value) {\n      return setFilters(_objectSpread({}, filters, _defineProperty({}, filter, value)));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }), React.createElement(Results, {\n    results: search.results,\n    filters: filters,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  })));\n}","map":{"version":3,"sources":["/Users/alvinng/LHL-full-time-teaching/webflex-lecture-notes-oct-2022/M8W20 Cypress end to end testing/react-albums/src/components/LiveSearch.js"],"names":["React","Fragment","useState","useEffect","useRef","differenceInDays","axios","SearchBar","Error","Filters","Results","LiveSearch","props","term","results","loading","search","setSearch","Explicit","Single","EP","filters","setFilters","error","setError","prev","showError","current","get","then","response","data","sort","a","b","Date","releaseDate","catch","event","filter","value"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect, useRef } from \"react\";\n\nimport { differenceInDays } from \"date-fns\";\n\nimport axios from \"axios\";\n\nimport SearchBar from \"components/SearchBar\";\nimport Error from \"components/Error\";\nimport Filters from \"components/Filters\";\nimport Results from \"components/Results\";\n\nexport default function LiveSearch(props) {\n  const [search, setSearch] = useState({\n    term: \"\",\n    results: [],\n    loading: false\n  });\n\n  const [filters, setFilters] = useState({\n    Explicit: true,\n    \"1900s\": true,\n    \"2000s\": true,\n    Single: false,\n    EP: false\n  });\n\n  const [error, setError] = useState(false);\n\n  const prev = useRef(\"\");\n\n  function showError() {\n    setSearch({\n      term: \"\",\n      results: [],\n      loading: false\n    });\n\n    setError(true);\n  }\n\n  useEffect(() => {\n    if (prev.current === \"\" && search.term === \"\") return;\n\n    setSearch(prev => ({\n      ...prev,\n      loading: true\n    }));\n\n    prev.current = search.term;\n\n    axios\n      .get(\n        `https://itunes.apple.com/search?term=${search.term}&country=CA&media=music&entity=album&attribute=artistTerm`\n      )\n      .then(response => {\n        response.data.results.sort((a, b) => {\n          return differenceInDays(\n            new Date(b.releaseDate),\n            new Date(a.releaseDate)\n          );\n        });\n\n        setSearch(search => ({\n          ...search,\n          results: response.data.results,\n          loading: false\n        }));\n      })\n      .catch(error => {\n        showError();\n      });\n  }, [search.term]);\n\n  return (\n    <Fragment>\n      <header className=\"logo\">\n        <img src=\"images/brand.png\" alt=\"Brand\" />\n      </header>\n      <main>\n        <SearchBar\n          loading={search.loading}\n          onSearch={term => setSearch({ ...search, term })}\n        />\n        <Error show={error} onClose={event => setError(false)}>\n          The server returned an error.\n        </Error>\n        <Filters\n          filters={filters}\n          setFilter={(filter, value) =>\n            setFilters({ ...filters, [filter]: value })\n          }\n        />\n        <Results results={search.results} filters={filters} />\n      </main>\n    </Fragment>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}